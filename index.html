<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Food Logger</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header class="topbar">
  <div class="left">
    <button onclick="exportData()" title="Export">â¬‡ï¸</button>
    <button title="Import" onclick="this.querySelector('input').click()">
      â¬†ï¸<input type="file" hidden onchange="importData(this)">
    </button>
  </div>
  <div class="right">
    <button onclick="showPanel('plot')">ğŸ“Š</button>
    <button onclick="showPanel('data')">ğŸ—‚ï¸</button>
    <button onclick="showPanel('add')">â•</button>
  </div>
</header>

<main class="panels">

  <!-- PLOT PANEL -->
  <section class="panel" id="panel-plot" hidden>
    <div id="chart-wrapper">
      <button id="maximizeBtn">â›¶</button>
      <div id="chart-layout">
        <div id="canvas-container">
          <canvas id="plot"></canvas>
        </div>
        <div id="legend-container"></div>
      </div>
    </div>
  </section>

  <!-- DATA PANEL -->
  <section class="panel" id="panel-data" hidden>
    <h2>Database</h2>
    <div class="table-controls">
      <input
        type="text"
        id="searchInput"
        placeholder="Search textâ€¦"
      />
      <button id="searchBtn">Search</button>
      <button id="clearBtn">Clear</button>
    </div>
    <br>
    <label id="databaseStatus">Database statusâ€¦</label><br><br>
    <div class="table-wrap">
      <table id="dataTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Text</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- ADD PANEL -->
  <section class="panel" id="panel-add">
    <h2>Add entry</h2>

    <label>Date and time</label>
    <input type="datetime-local" id="dt">

    <label>Text</label>
    <div class="input-row">
      <textarea
        id="textNewEntry"
        placeholder="comma separated text"
        rows="1"
        oninput="autoGrow(this)"
        onfocus="this.setSelectionRange(this.value.length, this.value.length)"
      ></textarea>
      <button class="clear-btn" onclick="textNewEntry.value='';autoGrow(textNewEntry)">Ã—</button>
      <button class="primary" onclick="addEntry()">Save</button>
      <button class="secondary" id="discardBtn" onclick="discardEdit()" hidden>Discard</button>
    </div>
    
    <div class="input-row">
      <input
        type="text"
        id="quickFilter"
        placeholder="quick buttons filter ..."
        oninput="updateQuickButtons()"
      >
      <button class="clear-btn" onclick="
        this.previousElementSibling.value='';
        updateQuickButtons();
      ">Ã—</button>
    </div>

    <div id="quickButtons" class="quick-buttons"></div>
  </section>

</main>

<footer id="appVersionFooter" style="
  font-family: system-ui, sans-serif;
  font-size: 12px;
  padding: 6px;
  border-top: 1px solid #ccc;
">
  <div>Last update: 2026-01-06</div>
  <div id="pwaStatusLine">Checking app statusâ€¦</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.2.0/dist/chartjs-plugin-zoom.min.js"></script>
<script src="js/check.js"></script>
<script src="js/db.js"></script>
<script src="js/table.js"></script>
<script src="js/entry.js"></script>
<script src="js/plot.js"></script>
<script src="js/app.js"></script>

</body>
</html>
